by .
david williams .
updated : .
02:26 est , 14 september 2011 .
security forces killed the last of six taliban fighters in kabul today to bring to an end a 20-hour siege on the afghan capital .
suicide bombers struck the u.s. embassy and nato headquarters in the city yesterday in a series of co-ordinated attacks .
it finally ended this morning in a flurry of gunfire as six of the terrorists were killed .
at least seven innocent people , including four policemen , were killed in the assault .
the attacks proved yet again that despite massive security , the taliban can strike at will against key targets in the capital .
gun-battle : a nato chopper hovers over the building where taliban militants took positions to launch attacks in kabul .
assault : the helicopter circles the building where taliban fighters are holed up .
ready for action : afghan soldiers take position at the scene after the taliban attack .
rockets and bullets were fired into the american compound , while suicide bombers struck against police and intelligence targets .
the insurgents holed up in an unfinished high-rise building overlooking the diplomatic quarter , armed with rockets .
afghan security forces fought them floor-by-floor during what was the longest sustained attack on the capital since the u.s.-led invasion a decade ago .
a few fighters held out overnight , with residents taking cover indoors with their lights off and helicopters flying low overhead .
u.s. secretary of state hillary clinton condemned the attack on the embassy as ` cowardly ' .
coming two days after the tenth anniversary of the september 11 atrocities , the well-planned assaults carried an unsettling message to western leaders and their afghan allies about the resilience and reach of the taliban network .
afghan officials have claimed their capital was protected by a ` ring of steel ' but there is now concern about their inability to secure the city without western help .
last month suicide bombers and gunmen stormed the british council offices in the city , leaving 12 dead after a seven-hour siege .
on guard : an afghan soldier stands alert on the gun battle site in kabul .
stand-off : afghan security forces fire at the building where armed attackers were holed up for hours .
security services stand by near the building