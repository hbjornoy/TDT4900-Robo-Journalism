terrifying video footage has revealed the moment a drug dealer pulled out a gun on an undercover cop in florida .
scott perala , an agent for the bureau of alcohol , tobacco and firearms , was buying two ak-47s and prescription pills from two suspects in a parking lot in cocoa beach when the incident unfolded .
although the confrontation , which was caught on perala 's body camera , occurred in 2010 , wesh has just secured the footage .
it shows perala , who had previously carried out hundreds of successful undercover operations , climbing into the backseat of a car where suspects jeremy williams and beaver duncan are waiting .
scroll down for video .
fears : a suspect can be seen pulling a gun at an undercover agent during a routine operation in florida .
the agent had climbed into their car to buy guns and pills when the two men tried to rob him .
threats : the suspect tells the agent to give him the $ 2,000 he had brought to buy the guns and pills .
after greeting the men , he takes a pouch of oxycodone pills and starts to count them when he suddenly looks up to see a handgun and an ak-47 being pulled at him .
` it was three inches from my head ... that barrel looked like a cannon , ' perala told wesh .
he puts up his hands as he pleads with the men - while they demand him to put down the $ 2,000 he had brought to purchase the guns and pills .
perala jumps from the car as a shot is fired at him and , after taking cover behind an suv , he pulls out his own weapon and fires repeatedly as they drive away .
the men sped off and took shelter behind a daycare , where they were captured following another shootout with responding officers .
fighting back : the agent can be seen pulling his gun out and shooting at the suspects as they race away .
lucky escape : scott perala , an agent for the alcohol , tobacco and firearms agency , who was in the video , said the terrifying experience was worth it to keep the men off the streets .
locked up : the two men in the car , beaver duncan